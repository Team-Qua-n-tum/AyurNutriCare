var D=Uint8Array,C=Uint16Array,lr=Int32Array,hr=new D([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),ur=new D([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ir=new D([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fr=function(r,a){for(var v=new C(31),n=0;n<31;++n)v[n]=a+=1<<r[n-1];for(var e=new lr(v[30]),n=1;n<30;++n)for(var f=v[n];f<v[n+1];++f)e[f]=f-v[n]<<5|n;return{b:v,r:e}},xr=Fr(hr,2),Sr=xr.b,vr=xr.r;Sr[28]=258,vr[258]=28;var Ur=Fr(ur,0),gr=Ur.r,er=new C(32768);for(var t=0;t<32768;++t){var O=(t&43690)>>1|(t&21845)<<1;O=(O&52428)>>2|(O&13107)<<2,O=(O&61680)>>4|(O&3855)<<4,er[t]=((O&65280)>>8|(O&255)<<8)>>1}var j=(function(r,a,v){for(var n=r.length,e=0,f=new C(a);e<n;++e)r[e]&&++f[r[e]-1];var h=new C(a);for(e=1;e<a;++e)h[e]=h[e-1]+f[e-1]<<1;var w;if(v){w=new C(1<<a);var c=15-a;for(e=0;e<n;++e)if(r[e])for(var g=e<<4|r[e],l=a-r[e],F=h[r[e]-1]++<<l,k=F|(1<<l)-1;F<=k;++F)w[er[F]>>c]=g}else for(w=new C(n),e=0;e<n;++e)r[e]&&(w[e]=er[h[r[e]-1]++]>>15-r[e]);return w}),R=new D(288);for(var t=0;t<144;++t)R[t]=8;for(var t=144;t<256;++t)R[t]=9;for(var t=256;t<280;++t)R[t]=7;for(var t=280;t<288;++t)R[t]=8;var m=new D(32);for(var t=0;t<32;++t)m[t]=5;var br=j(R,9,0),qr=j(m,5,0),Ar=function(r){return(r+7)/8|0},Ir=function(r,a,v){return(v==null||v>r.length)&&(v=r.length),new D(r.subarray(a,v))},K=function(r,a,v){v<<=a&7;var n=a/8|0;r[n]|=v,r[n+1]|=v>>8},$=function(r,a,v){v<<=a&7;var n=a/8|0;r[n]|=v,r[n+1]|=v>>8,r[n+2]|=v>>16},nr=function(r,a){for(var v=[],n=0;n<r.length;++n)r[n]&&v.push({s:n,f:r[n]});var e=v.length,f=v.slice();if(!e)return{t:zr,l:0};if(e==1){var h=new D(v[0].s+1);return h[v[0].s]=1,{t:h,l:1}}v.sort(function(T,b){return T.f-b.f}),v.push({s:-1,f:25001});var w=v[0],c=v[1],g=0,l=1,F=2;for(v[0]={s:-1,f:w.f+c.f,l:w,r:c};l!=e-1;)w=v[v[g].f<v[F].f?g++:F++],c=v[g!=l&&v[g].f<v[F].f?g++:F++],v[l++]={s:-1,f:w.f+c.f,l:w,r:c};for(var k=f[0].s,n=1;n<e;++n)f[n].s>k&&(k=f[n].s);var x=new C(k+1),S=fr(v[l-1],x,0);if(S>a){var n=0,M=0,L=S-a,P=1<<L;for(f.sort(function(b,A){return x[A.s]-x[b.s]||b.f-A.f});n<e;++n){var J=f[n].s;if(x[J]>a)M+=P-(1<<S-x[J]),x[J]=a;else break}for(M>>=L;M>0;){var Q=f[n].s;x[Q]<a?M-=1<<a-x[Q]++-1:++n}for(;n>=0&&M;--n){var U=f[n].s;x[U]==a&&(--x[U],++M)}S=a}return{t:new D(x),l:S}},fr=function(r,a,v){return r.s==-1?Math.max(fr(r.l,a,v+1),fr(r.r,a,v+1)):a[r.s]=v},Mr=function(r){for(var a=r.length;a&&!r[--a];);for(var v=new C(++a),n=0,e=r[0],f=1,h=function(c){v[n++]=c},w=1;w<=a;++w)if(r[w]==e&&w!=a)++f;else{if(!e&&f>2){for(;f>138;f-=138)h(32754);f>2&&(h(f>10?f-11<<5|28690:f-3<<5|12305),f=0)}else if(f>3){for(h(e),--f;f>6;f-=6)h(8304);f>2&&(h(f-3<<5|8208),f=0)}for(;f--;)h(e);f=1,e=r[w]}return{c:v.subarray(0,n),n:a}},_=function(r,a){for(var v=0,n=0;n<a.length;++n)v+=r[n]*a[n];return v},sr=function(r,a,v){var n=v.length,e=Ar(a+2);r[e]=n&255,r[e+1]=n>>8,r[e+2]=r[e]^255,r[e+3]=r[e+1]^255;for(var f=0;f<n;++f)r[e+f+4]=v[f];return(e+4+n)*8},yr=function(r,a,v,n,e,f,h,w,c,g,l){K(a,l++,v),++e[256];for(var F=nr(e,15),k=F.t,x=F.l,S=nr(f,15),M=S.t,L=S.l,P=Mr(k),J=P.c,Q=P.n,U=Mr(M),T=U.c,b=U.n,A=new C(19),o=0;o<J.length;++o)++A[J[o]&31];for(var o=0;o<T.length;++o)++A[T[o]&31];for(var u=nr(A,7),s=u.t,V=u.l,z=19;z>4&&!s[ir[z-1]];--z);var W=g+5<<3,q=_(e,R)+_(f,m)+h,I=_(e,k)+_(f,M)+h+14+3*z+_(A,s)+2*A[16]+3*A[17]+7*A[18];if(c>=0&&W<=q&&W<=I)return sr(a,l,r.subarray(c,c+g));var E,i,B,N;if(K(a,l,1+(I<q)),l+=2,I<q){E=j(k,x,0),i=k,B=j(M,L,0),N=M;var p=j(s,V,0);K(a,l,Q-257),K(a,l+5,b-1),K(a,l+10,z-4),l+=14;for(var o=0;o<z;++o)K(a,l+3*o,s[ir[o]]);l+=3*z;for(var G=[J,T],Z=0;Z<2;++Z)for(var X=G[Z],o=0;o<X.length;++o){var H=X[o]&31;K(a,l,p[H]),l+=s[H],H>15&&(K(a,l,X[o]>>5&127),l+=X[o]>>12)}}else E=br,i=R,B=qr,N=m;for(var o=0;o<w;++o){var y=n[o];if(y>255){var H=y>>18&31;$(a,l,E[H+257]),l+=i[H+257],H>7&&(K(a,l,y>>23&31),l+=hr[H]);var Y=y&31;$(a,l,B[Y]),l+=N[Y],Y>3&&($(a,l,y>>5&8191),l+=ur[Y])}else $(a,l,E[y]),l+=i[y]}return $(a,l,E[256]),l+i[256]},Br=new lr([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),zr=new D(0),Dr=function(r,a,v,n,e,f){var h=f.z||r.length,w=new D(n+h+5*(1+Math.ceil(h/7e3))+e),c=w.subarray(n,w.length-e),g=f.l,l=(f.r||0)&7;if(a){l&&(c[0]=f.r>>3);for(var F=Br[a-1],k=F>>13,x=F&8191,S=(1<<v)-1,M=f.p||new C(32768),L=f.h||new C(S+1),P=Math.ceil(v/3),J=2*P,Q=function(ar){return(r[ar]^r[ar+1]<<P^r[ar+2]<<J)&S},U=new lr(25e3),T=new C(288),b=new C(32),A=0,o=0,u=f.i||0,s=0,V=f.w||0,z=0;u+2<h;++u){var W=Q(u),q=u&32767,I=L[W];if(M[q]=I,L[W]=q,V<=u){var E=h-u;if((A>7e3||s>24576)&&(E>423||!g)){l=yr(r,c,0,U,T,b,o,s,z,u-z,l),s=A=o=0,z=u;for(var i=0;i<286;++i)T[i]=0;for(var i=0;i<30;++i)b[i]=0}var B=2,N=0,p=x,G=q-I&32767;if(E>2&&W==Q(u-G))for(var Z=Math.min(k,E)-1,X=Math.min(32767,u),H=Math.min(258,E);G<=X&&--p&&q!=I;){if(r[u+B]==r[u+B-G]){for(var y=0;y<H&&r[u+y]==r[u+y-G];++y);if(y>B){if(B=y,N=G,y>Z)break;for(var Y=Math.min(G,y-2),or=0,i=0;i<Y;++i){var d=u-G+i&32767,Tr=M[d],wr=d-Tr&32767;wr>or&&(or=wr,I=d)}}}q=I,I=M[q],G+=q-I&32767}if(N){U[s++]=268435456|vr[B]<<18|gr[N];var tr=vr[B]&31,cr=gr[N]&31;o+=hr[tr]+ur[cr],++T[257+tr],++b[cr],V=u+B,++A}else U[s++]=r[u],++T[r[u]]}}for(u=Math.max(u,V);u<h;++u)U[s++]=r[u],++T[r[u]];l=yr(r,c,g,U,T,b,o,s,z,u-z,l),g||(f.r=l&7|c[l/8|0]<<3,l-=7,f.h=L,f.p=M,f.i=u,f.w=V)}else{for(var u=f.w||0;u<h+g;u+=65535){var rr=u+65535;rr>=h&&(c[l/8|0]=g,rr=h),l=sr(c,l+1,r.subarray(u,rr))}f.i=h}return Ir(w,0,n+Ar(l)+e)},Cr=function(){var r=1,a=0;return{p:function(v){for(var n=r,e=a,f=v.length|0,h=0;h!=f;){for(var w=Math.min(h+2655,f);h<w;++h)e+=n+=v[h];n=(n&65535)+15*(n>>16),e=(e&65535)+15*(e>>16)}r=n,a=e},d:function(){return r%=65521,a%=65521,(r&255)<<24|(r&65280)<<8|(a&255)<<8|a>>8}}},Er=function(r,a,v,n,e){if(!e&&(e={l:1},a.dictionary)){var f=a.dictionary.subarray(-32768),h=new D(f.length+r.length);h.set(f),h.set(r,f.length),r=h,e.w=f.length}return Dr(r,a.level==null?6:a.level,a.mem==null?e.l?Math.ceil(Math.max(8,Math.min(13,Math.log(r.length)))*1.5):20:12+a.mem,v,n,e)},kr=function(r,a,v){for(;v;++a)r[a]=v,v>>>=8},Gr=function(r,a){var v=a.level,n=v==0?0:v<6?1:v==9?3:2;if(r[0]=120,r[1]=n<<6|(a.dictionary&&32),r[1]|=31-(r[0]<<8|r[1])%31,a.dictionary){var e=Cr();e.p(a.dictionary),kr(r,2,e.d())}};function Kr(r,a){a||(a={});var v=Cr();v.p(r);var n=Er(r,a,a.dictionary?6:2,4);return Gr(n,a),kr(n,n.length-4,v.d()),n}var Hr=typeof TextDecoder<"u"&&new TextDecoder,Jr=0;try{Hr.decode(zr,{stream:!0}),Jr=1}catch{}export{Kr as z};
